
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta property="og:title" content="Individual glacier data inspection" />
  
<meta property="og:type" content="website" />
  
<meta property="og:url" content="https://e-marshall.github.io/itslive/ind_glacier_data_inspection_analysis.html" />
  
<meta property="og:description" content="This notebook will walk through steps to read in and organize velocity data and clip it to the extent of a single glacier. The tools we will use include xarray, rioxarray, geopandas, and flox. To c..." />
  
<meta property="og:image" content="https://e-marshall.github.io/itslive/_static/itslive_explore_img.png" />
  
<meta property="og:image:alt" content="Individual glacier data inspection" />
  
    <title>Individual glacier data inspection &#8212; Using xarray to examine cloud-based glacier surface velocity data</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" href="_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script src="_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Individual glacier surface velocity analysis" href="ind_glacier_analysis_new.html" />
    <link rel="prev" title="Accessing ITS_LIVE data via S3 bucket" href="accessing_s3_data_noregion.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Using xarray to examine cloud-based glacier surface velocity data</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="software.html">
   Software and Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="accessing_s3_data_noregion.html">
   Accessing ITS_LIVE data via S3 bucket
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Individual glacier data inspection
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="ind_glacier_analysis_new.html">
   Individual glacier surface velocity analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="glacier_analysis_grouped.html">
   Region-scale glacier analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Summary.html">
   Summary
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Acknowledgments.html">
   Acknowledgments
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="References.html">
   References
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/e-marshall/itslive/master?urlpath=lab/tree/ind_glacier_data_inspection_analysis.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/e-marshall/itslive"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/e-marshall/itslive/issues/new?title=Issue%20on%20page%20%2Find_glacier_data_inspection_analysis.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="_sources/ind_glacier_data_inspection_analysis.ipynb"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.ipynb</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#reading-in-its-live-data">
   Reading in ITS_LIVE data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#read-in-vector-data">
   Read in vector data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#crop-rgi-to-its-live-extent">
   Crop RGI to ITS_LIVE extent
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#clip-its-live-dataset-to-individual-glacier-extent">
     Clip ITS_LIVE dataset to individual glacier extent
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exploring-its-live-data">
   Exploring ITS_LIVE data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#examining-velocity-data-from-each-satellite-in-its-live-dataset">
   Examining velocity data from each satellite in
   <code class="docutils literal notranslate">
    <span class="pre">
     ITS_LIVE
    </span>
   </code>
   dataset
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#checking-coverage-along-a-dimension">
   Checking coverage along a dimension
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#looking-into-mid-dates-dimension">
     Looking into
     <code class="docutils literal notranslate">
      <span class="pre">
       mid_dates
      </span>
     </code>
     dimension…
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exploring-data-coverage-over-time-series">
   Exploring data coverage over time series
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Individual glacier data inspection</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#reading-in-its-live-data">
   Reading in ITS_LIVE data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#read-in-vector-data">
   Read in vector data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#crop-rgi-to-its-live-extent">
   Crop RGI to ITS_LIVE extent
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#clip-its-live-dataset-to-individual-glacier-extent">
     Clip ITS_LIVE dataset to individual glacier extent
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exploring-its-live-data">
   Exploring ITS_LIVE data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#examining-velocity-data-from-each-satellite-in-its-live-dataset">
   Examining velocity data from each satellite in
   <code class="docutils literal notranslate">
    <span class="pre">
     ITS_LIVE
    </span>
   </code>
   dataset
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#checking-coverage-along-a-dimension">
   Checking coverage along a dimension
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#looking-into-mid-dates-dimension">
     Looking into
     <code class="docutils literal notranslate">
      <span class="pre">
       mid_dates
      </span>
     </code>
     dimension…
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#exploring-data-coverage-over-time-series">
   Exploring data coverage over time series
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="individual-glacier-data-inspection">
<h1>Individual glacier data inspection<a class="headerlink" href="#individual-glacier-data-inspection" title="Permalink to this headline">#</a></h1>
<p>This notebook will walk through steps to read in and organize velocity data and clip it to the extent of a single glacier. The tools we will use include <strong>xarray</strong>, <strong>rioxarray</strong>, <strong>geopandas</strong>, and <strong>flox</strong>.</p>
<p>To clip its_live data to the extent of a single glacier we will use a vector dataset of glacier outlines, the <a class="reference external" href="https://nsidc.org/data/nsidc-0770">Randolph Glacier Inventory</a>.</p>
<p><em>Learning goals:</em></p>
<ul class="simple">
<li><p>subset large raster to spatial area of interest</p></li>
<li><p>exploring dataset with <strong>dask</strong> and <strong>xarray</strong></p></li>
<li><p>dataset inspection using</p>
<ul>
<li><p>xarray label and index-based selections</p></li>
<li><p>grouped computations and reductions</p></li>
<li><p>visualization</p></li>
</ul>
</li>
</ul>
<p>First, lets install the python libraries that we’ll need for this notebook:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="kn">import</span> <span class="nn">rioxarray</span> <span class="k">as</span> <span class="nn">rxr</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.ticker</span> <span class="k">as</span> <span class="nn">mticker</span>
<span class="kn">from</span> <span class="nn">shapely.geometry</span> <span class="kn">import</span> <span class="n">Polygon</span>
<span class="kn">from</span> <span class="nn">shapely.geometry</span> <span class="kn">import</span> <span class="n">Point</span>
<span class="kn">import</span> <span class="nn">cartopy.crs</span> <span class="k">as</span> <span class="nn">ccrs</span>
<span class="kn">from</span> <span class="nn">cartopy.mpl.gridliner</span> <span class="kn">import</span> <span class="n">LONGITUDE_FORMATTER</span><span class="p">,</span> <span class="n">LATITUDE_FORMATTER</span>
<span class="kn">import</span> <span class="nn">cartopy</span>
<span class="kn">import</span> <span class="nn">cartopy.feature</span> <span class="k">as</span> <span class="nn">cfeature</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">urllib.request</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="c1">#import flox</span>
<span class="o">%</span><span class="k">config</span> InlineBackend.figure_format=&#39;retina&#39;
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="nn">Input In [1],</span> in <span class="ni">&lt;cell line: 10&gt;</span><span class="nt">()</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span> <span class="kn">from</span> <span class="nn">shapely.geometry</span> <span class="kn">import</span> <span class="n">Polygon</span>
<span class="g g-Whitespace">      </span><span class="mi">9</span> <span class="kn">from</span> <span class="nn">shapely.geometry</span> <span class="kn">import</span> <span class="n">Point</span>
<span class="ne">---&gt; </span><span class="mi">10</span> <span class="kn">import</span> <span class="nn">cartopy.crs</span> <span class="k">as</span> <span class="nn">ccrs</span>
<span class="g g-Whitespace">     </span><span class="mi">11</span> <span class="kn">from</span> <span class="nn">cartopy.mpl.gridliner</span> <span class="kn">import</span> <span class="n">LONGITUDE_FORMATTER</span><span class="p">,</span> <span class="n">LATITUDE_FORMATTER</span>
<span class="g g-Whitespace">     </span><span class="mi">12</span> <span class="kn">import</span> <span class="nn">cartopy</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;cartopy&#39;
</pre></div>
</div>
</div>
</div>
<div class="section" id="reading-in-its-live-data">
<h2>Reading in ITS_LIVE data<a class="headerlink" href="#reading-in-its-live-data" title="Permalink to this headline">#</a></h2>
<p>We will use some of the functions we defined in the data access notebook in this notebook and others within this tutorial. They will all be within the <code class="docutils literal notranslate"><span class="pre">itslivetools</span></code> package.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">itslivetools</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="nn">Input In [2],</span> in <span class="ni">&lt;cell line: 1&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="kn">import</span> <span class="nn">itslivetools</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;itslivetools&#39;
</pre></div>
</div>
</div>
</div>
<p>First, let’s read in the catalog again:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="s1">&#39;https://its-live-data.s3.amazonaws.com/datacubes/catalog_v02.json&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">url_catalog</span><span class="p">:</span>
    <span class="n">itslive_catalog</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">url_catalog</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">())</span>
<span class="n">itslive_catalog</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">Input In [3],</span> in <span class="ni">&lt;cell line: 1&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="k">with</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="s1">&#39;https://its-live-data.s3.amazonaws.com/datacubes/catalog_v02.json&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">url_catalog</span><span class="p">:</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span>     <span class="n">itslive_catalog</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">url_catalog</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">decode</span><span class="p">())</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">itslive_catalog</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>

<span class="ne">NameError</span>: name &#39;urllib&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">read_in_s3()</span></code> function will take a url that points to a zarr data cube stored in an AWS S3 bucket and return an xarray dataset.</p>
<p>I started with <code class="docutils literal notranslate"><span class="pre">chunk_size='auto'</span></code> which will choose chunk sizes that match the underlying data structure (this is generally ideal). More about choosing good chunk sizes <a class="reference external" href="https://blog.dask.org/2021/11/02/choosing-dask-chunk-sizes">here</a>. If you want to use a different chunk size, specify it when you call the <code class="docutils literal notranslate"><span class="pre">read_in_s3()</span></code> function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">url</span> <span class="o">=</span> <span class="n">itslivetools</span><span class="o">.</span><span class="n">find_granule_by_point</span><span class="p">(</span><span class="n">itslive_catalog</span><span class="p">,</span> <span class="p">[</span><span class="mf">84.56</span><span class="p">,</span> <span class="mf">28.54</span><span class="p">])</span>
<span class="n">url</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">Input In [4],</span> in <span class="ni">&lt;cell line: 1&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">url</span> <span class="o">=</span> <span class="n">itslivetools</span><span class="o">.</span><span class="n">find_granule_by_point</span><span class="p">(</span><span class="n">itslive_catalog</span><span class="p">,</span> <span class="p">[</span><span class="mf">84.56</span><span class="p">,</span> <span class="mf">28.54</span><span class="p">])</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">url</span>

<span class="ne">NameError</span>: name &#39;itslivetools&#39; is not defined
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dc</span> <span class="o">=</span> <span class="n">itslivetools</span><span class="o">.</span><span class="n">read_in_s3</span><span class="p">(</span><span class="n">url</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">dc</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">Input In [5],</span> in <span class="ni">&lt;cell line: 1&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">dc</span> <span class="o">=</span> <span class="n">itslivetools</span><span class="o">.</span><span class="n">read_in_s3</span><span class="p">(</span><span class="n">url</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">dc</span>

<span class="ne">NameError</span>: name &#39;itslivetools&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>We are reading this in as a dask array. Let’s take a look at the chunk sizes:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>chunksizes shows the largest chunk size. chunks shows the sizes of all chunks along all dims, better if you have irregular chunks</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dc</span><span class="o">.</span><span class="n">chunksizes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">Input In [6],</span> in <span class="ni">&lt;cell line: 1&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">dc</span><span class="o">.</span><span class="n">chunksizes</span>

<span class="ne">NameError</span>: name &#39;dc&#39; is not defined
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dc</span><span class="o">.</span><span class="n">chunks</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">Input In [7],</span> in <span class="ni">&lt;cell line: 1&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">dc</span><span class="o">.</span><span class="n">chunks</span>

<span class="ne">NameError</span>: name &#39;dc&#39; is not defined
</pre></div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Setting the dask chunksize to <code class="docutils literal notranslate"><span class="pre">auto</span></code> at the <code class="docutils literal notranslate"><span class="pre">xr.open_dataset()</span></code> step will use chunk sizes that most closely resemble the structure of the underlying data. To avoid imposing a chunk size that isn’t a good fit for the data, avoid re-chunking until we have selected a subset of our area of interest from the larger dataset</p>
</div>
<p>Check CRS of xr object:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dc</span><span class="o">.</span><span class="n">mapping</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">Input In [8],</span> in <span class="ni">&lt;cell line: 1&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">dc</span><span class="o">.</span><span class="n">mapping</span>

<span class="ne">NameError</span>: name &#39;dc&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>Let’s take a look at the time dimension (<code class="docutils literal notranslate"><span class="pre">mid_date</span></code> here). To start with we’ll just print the first 10 values:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="n">dc</span><span class="o">.</span><span class="n">mid_date</span><span class="p">[</span><span class="n">element</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">Input In [9],</span> in <span class="ni">&lt;cell line: 1&gt;</span><span class="nt">()</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
<span class="ne">----&gt; </span><span class="mi">3</span>     <span class="nb">print</span><span class="p">(</span><span class="n">dc</span><span class="o">.</span><span class="n">mid_date</span><span class="p">[</span><span class="n">element</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;dc&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>Weird, it doesn’t look like the time dimension is in chronological order, let’s fix that:</p>
<div class="cell tag_scroll-output tag_output-scroll docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dc_timesorted</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">sortby</span><span class="p">(</span><span class="n">dc</span><span class="p">[</span><span class="s1">&#39;mid_date&#39;</span><span class="p">])</span>
<span class="n">dc_timesorted</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">Input In [10],</span> in <span class="ni">&lt;cell line: 1&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">dc_timesorted</span> <span class="o">=</span> <span class="n">dc</span><span class="o">.</span><span class="n">sortby</span><span class="p">(</span><span class="n">dc</span><span class="p">[</span><span class="s1">&#39;mid_date&#39;</span><span class="p">])</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">dc_timesorted</span>

<span class="ne">NameError</span>: name &#39;dc&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>When we read in the zarr datacube as a <code class="docutils literal notranslate"><span class="pre">xr.Dataset</span></code> we set the chunk sizes to <code class="docutils literal notranslate"><span class="pre">auto</span></code>. When we try to sort along the <code class="docutils literal notranslate"><span class="pre">mid_date</span></code> dimension this seems to become a problem and we get the warning above.</p>
<p>At first it makes sense to follow the instructions in the warning message to avoid creating large chunks, but this creates some issues. If you want, turn the cell below to <code class="docutils literal notranslate"><span class="pre">code</span></code> and run it, you can see that this re-chunks the time dimension which isn’t something that we want.</p>
<p>#turn this to code</p>
<p>import dask
with dask.config.set(**{‘array.slicing.split_large_chunks’: True}):
dc_timesorted_false = dc.sortby(dc[‘mid_date’])
dc_timesorted_false</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dc_timesorted</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">Input In [11],</span> in <span class="ni">&lt;cell line: 1&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">dc_timesorted</span>

<span class="ne">NameError</span>: name &#39;dc_timesorted&#39; is not defined
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    
    <span class="nb">print</span><span class="p">(</span><span class="n">dc_timesorted</span><span class="o">.</span><span class="n">mid_date</span><span class="p">[</span><span class="n">element</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">Input In [12],</span> in <span class="ni">&lt;cell line: 1&gt;</span><span class="nt">()</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
<span class="ne">----&gt; </span><span class="mi">3</span>     <span class="nb">print</span><span class="p">(</span><span class="n">dc_timesorted</span><span class="o">.</span><span class="n">mid_date</span><span class="p">[</span><span class="n">element</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;dc_timesorted&#39; is not defined
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="read-in-vector-data">
<h2>Read in vector data<a class="headerlink" href="#read-in-vector-data" title="Permalink to this headline">#</a></h2>
<p>We are going to read in RGI region 15 (SouthAsiaEast). RGI data is downloaded in lat/lon coordinates. We will project it to match the CRS of the ITS_LIVE dataset and then select an individual glacier to begin our analysis.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">se_asia</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="s1">&#39;https://github.com/e-marshall/itslive/raw/master/rgi15_southasiaeast.geojson&#39;</span><span class="p">)</span>
<span class="n">se_asia</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>RGIId</th>
      <th>GLIMSId</th>
      <th>BgnDate</th>
      <th>EndDate</th>
      <th>CenLon</th>
      <th>CenLat</th>
      <th>O1Region</th>
      <th>O2Region</th>
      <th>Area</th>
      <th>Zmin</th>
      <th>...</th>
      <th>Aspect</th>
      <th>Lmax</th>
      <th>Status</th>
      <th>Connect</th>
      <th>Form</th>
      <th>TermType</th>
      <th>Surging</th>
      <th>Linkages</th>
      <th>Name</th>
      <th>geometry</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>RGI60-15.00001</td>
      <td>G102044E29941N</td>
      <td>19990920</td>
      <td>-9999999</td>
      <td>102.044042</td>
      <td>29.941000</td>
      <td>15</td>
      <td>3</td>
      <td>0.438</td>
      <td>4996</td>
      <td>...</td>
      <td>251</td>
      <td>850</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>9</td>
      <td>9</td>
      <td>None</td>
      <td>POLYGON ((102.03759 29.93828, 102.03759 29.938...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>RGI60-15.00002</td>
      <td>G102042E29987N</td>
      <td>19990920</td>
      <td>-9999999</td>
      <td>102.042346</td>
      <td>29.987019</td>
      <td>15</td>
      <td>3</td>
      <td>0.644</td>
      <td>4947</td>
      <td>...</td>
      <td>244</td>
      <td>1021</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>9</td>
      <td>9</td>
      <td>None</td>
      <td>POLYGON ((102.04195 29.99030, 102.04197 29.990...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>RGI60-15.00003</td>
      <td>G102041E29997N</td>
      <td>19990920</td>
      <td>-9999999</td>
      <td>102.041130</td>
      <td>29.997311</td>
      <td>15</td>
      <td>3</td>
      <td>0.225</td>
      <td>5019</td>
      <td>...</td>
      <td>274</td>
      <td>812</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>9</td>
      <td>9</td>
      <td>None</td>
      <td>POLYGON ((102.03710 29.99774, 102.03719 29.998...</td>
    </tr>
  </tbody>
</table>
<p>3 rows × 23 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#project rgi data to match itslive</span>
<span class="c1">#we know the epsg from looking at the &#39;spatial epsg&#39; attr of the mapping var of the dc object</span>
<span class="n">se_asia_prj</span> <span class="o">=</span> <span class="n">se_asia</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="s1">&#39;EPSG:32645&#39;</span><span class="p">)</span> 
<span class="n">se_asia_prj</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>RGIId</th>
      <th>GLIMSId</th>
      <th>BgnDate</th>
      <th>EndDate</th>
      <th>CenLon</th>
      <th>CenLat</th>
      <th>O1Region</th>
      <th>O2Region</th>
      <th>Area</th>
      <th>Zmin</th>
      <th>...</th>
      <th>Aspect</th>
      <th>Lmax</th>
      <th>Status</th>
      <th>Connect</th>
      <th>Form</th>
      <th>TermType</th>
      <th>Surging</th>
      <th>Linkages</th>
      <th>Name</th>
      <th>geometry</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>RGI60-15.00001</td>
      <td>G102044E29941N</td>
      <td>19990920</td>
      <td>-9999999</td>
      <td>102.044042</td>
      <td>29.941000</td>
      <td>15</td>
      <td>3</td>
      <td>0.438</td>
      <td>4996</td>
      <td>...</td>
      <td>251</td>
      <td>850</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>9</td>
      <td>9</td>
      <td>None</td>
      <td>POLYGON ((1959630.570 3408951.748, 1959630.394...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>RGI60-15.00002</td>
      <td>G102042E29987N</td>
      <td>19990920</td>
      <td>-9999999</td>
      <td>102.042346</td>
      <td>29.987019</td>
      <td>15</td>
      <td>3</td>
      <td>0.644</td>
      <td>4947</td>
      <td>...</td>
      <td>244</td>
      <td>1021</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>9</td>
      <td>9</td>
      <td>None</td>
      <td>POLYGON ((1959271.126 3414873.173, 1959273.308...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>RGI60-15.00003</td>
      <td>G102041E29997N</td>
      <td>19990920</td>
      <td>-9999999</td>
      <td>102.041130</td>
      <td>29.997311</td>
      <td>15</td>
      <td>3</td>
      <td>0.225</td>
      <td>5019</td>
      <td>...</td>
      <td>274</td>
      <td>812</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>9</td>
      <td>9</td>
      <td>None</td>
      <td>POLYGON ((1958682.136 3415647.929, 1958684.710...</td>
    </tr>
  </tbody>
</table>
<p>3 rows × 23 columns</p>
</div></div></div>
</div>
</div>
<div class="section" id="crop-rgi-to-its-live-extent">
<h2>Crop RGI to ITS_LIVE extent<a class="headerlink" href="#crop-rgi-to-its-live-extent" title="Permalink to this headline">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#first, get vector bbox of itslive</span>

<span class="n">bbox_dc</span> <span class="o">=</span> <span class="n">itslivetools</span><span class="o">.</span><span class="n">get_bbox_single</span><span class="p">(</span><span class="n">dc</span><span class="p">)</span>
<span class="n">bbox_dc</span><span class="p">[</span><span class="s1">&#39;geometry&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">Input In [15],</span> in <span class="ni">&lt;cell line: 3&gt;</span><span class="nt">()</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="c1">#first, get vector bbox of itslive</span>
<span class="ne">----&gt; </span><span class="mi">3</span> <span class="n">bbox_dc</span> <span class="o">=</span> <span class="n">itslivetools</span><span class="o">.</span><span class="n">get_bbox_single</span><span class="p">(</span><span class="n">dc</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="n">bbox_dc</span><span class="p">[</span><span class="s1">&#39;geometry&#39;</span><span class="p">]</span>

<span class="ne">NameError</span>: name &#39;itslivetools&#39; is not defined
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#project from latlon to local utm </span>
<span class="n">bbox_dc</span> <span class="o">=</span> <span class="n">bbox_dc</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="s1">&#39;EPSG:32645&#39;</span><span class="p">)</span>
<span class="n">bbox_dc</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">Input In [16],</span> in <span class="ni">&lt;cell line: 2&gt;</span><span class="nt">()</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="c1">#project from latlon to local utm </span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="n">bbox_dc</span> <span class="o">=</span> <span class="n">bbox_dc</span><span class="o">.</span><span class="n">to_crs</span><span class="p">(</span><span class="s1">&#39;EPSG:32645&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">bbox_dc</span>

<span class="ne">NameError</span>: name &#39;bbox_dc&#39; is not defined
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#subset rgi to bounds </span>
<span class="n">se_asia_subset</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">se_asia_prj</span><span class="p">,</span> <span class="n">bbox_dc</span><span class="p">)</span>
<span class="n">se_asia_subset</span>
<span class="n">se_asia_subset</span><span class="o">.</span><span class="n">explore</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">Input In [17],</span> in <span class="ni">&lt;cell line: 2&gt;</span><span class="nt">()</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="c1">#subset rgi to bounds </span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="n">se_asia_subset</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">se_asia_prj</span><span class="p">,</span> <span class="n">bbox_dc</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">se_asia_subset</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="n">se_asia_subset</span><span class="o">.</span><span class="n">explore</span><span class="p">()</span>

<span class="ne">NameError</span>: name &#39;bbox_dc&#39; is not defined
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample_glacier_vec</span> <span class="o">=</span> <span class="n">se_asia_subset</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">se_asia_subset</span><span class="p">[</span><span class="s1">&#39;RGIId&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;RGI60-15.04714&#39;</span><span class="p">]</span>
<span class="n">sample_glacier_vec</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">Input In [18],</span> in <span class="ni">&lt;cell line: 1&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">sample_glacier_vec</span> <span class="o">=</span> <span class="n">se_asia_subset</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">se_asia_subset</span><span class="p">[</span><span class="s1">&#39;RGIId&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;RGI60-15.04714&#39;</span><span class="p">]</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">sample_glacier_vec</span>

<span class="ne">NameError</span>: name &#39;se_asia_subset&#39; is not defined
</pre></div>
</div>
</div>
</div>
<div class="section" id="clip-its-live-dataset-to-individual-glacier-extent">
<h3>Clip ITS_LIVE dataset to individual glacier extent<a class="headerlink" href="#clip-its-live-dataset-to-individual-glacier-extent" title="Permalink to this headline">#</a></h3>
<p>First, we need to use <code class="docutils literal notranslate"><span class="pre">rio.write_crs()</span></code> to assign a CRS to the itslive object. If we don’t do that first the <code class="docutils literal notranslate"><span class="pre">rio.clip()</span></code> command will produce an error</p>
<p><em>Note</em>: you can only run write_crs() once, because it switches mapping from being a <code class="docutils literal notranslate"><span class="pre">data_var</span></code> to a <code class="docutils literal notranslate"><span class="pre">coord</span></code> so if you run it again it will produce a key error looking for a var that doesnt’ exist</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dc_timesorted</span> <span class="o">=</span> <span class="n">dc_timesorted</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">write_crs</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;epsg:</span><span class="si">{</span><span class="n">dc_timesorted</span><span class="o">.</span><span class="n">mapping</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;spatial_epsg&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">Input In [19],</span> in <span class="ni">&lt;cell line: 1&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">dc_timesorted</span> <span class="o">=</span> <span class="n">dc_timesorted</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">write_crs</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;epsg:</span><span class="si">{</span><span class="n">dc_timesorted</span><span class="o">.</span><span class="n">mapping</span><span class="o">.</span><span class="n">attrs</span><span class="p">[</span><span class="s1">&#39;spatial_epsg&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;dc_timesorted&#39; is not defined
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>

<span class="n">sample_glacier_raster</span> <span class="o">=</span> <span class="n">dc_timesorted</span><span class="o">.</span><span class="n">rio</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">sample_glacier_vec</span><span class="o">.</span><span class="n">geometry</span><span class="p">,</span> <span class="n">sample_glacier_vec</span><span class="o">.</span><span class="n">crs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="n">File</span> <span class="o">&lt;</span><span class="n">timed</span> <span class="n">exec</span><span class="o">&gt;</span><span class="p">:</span><span class="mi">1</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>

<span class="ne">NameError</span>: name &#39;dc_timesorted&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>Take a look at the clipped object:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample_glacier_raster</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">Input In [21],</span> in <span class="ni">&lt;cell line: 1&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">sample_glacier_raster</span>

<span class="ne">NameError</span>: name &#39;sample_glacier_raster&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>Let’s take a look at the clipped raster alongside the vector outline. To start with and for the sake of easy visualizing we will take the mean of the magnitude of velocity variable along the <code class="docutils literal notranslate"><span class="pre">mid_date</span></code> dimension:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample_glacier_raster_timemean</span> <span class="o">=</span> <span class="n">sample_glacier_raster</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;mid_date&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">Input In [22],</span> in <span class="ni">&lt;cell line: 1&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">sample_glacier_raster_timemean</span> <span class="o">=</span> <span class="n">sample_glacier_raster</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;mid_date&#39;</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;sample_glacier_raster&#39; is not defined
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">sample_glacier_raster_timemean</span><span class="o">.</span><span class="n">vx</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">sample_glacier_raster_timemean</span><span class="o">.</span><span class="n">vy</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">Input In [23],</span> in <span class="ni">&lt;cell line: 1&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">sample_glacier_raster_timemean</span><span class="o">.</span><span class="n">vx</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">sample_glacier_raster_timemean</span><span class="o">.</span><span class="n">vy</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>

<span class="ne">NameError</span>: name &#39;sample_glacier_raster_timemean&#39; is not defined
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">9</span><span class="p">))</span>
<span class="n">sample_glacier_vec</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">);</span>
<span class="n">sample_glacier_raster</span><span class="o">.</span><span class="n">v</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;mid_date&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">Input In [24],</span> in <span class="ni">&lt;cell line: 2&gt;</span><span class="nt">()</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">9</span><span class="p">))</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="n">sample_glacier_vec</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">);</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">sample_glacier_raster</span><span class="o">.</span><span class="n">v</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;mid_date&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;sample_glacier_vec&#39; is not defined
</pre></div>
</div>
<img alt="_images/ind_glacier_data_inspection_analysis_41_1.png" src="_images/ind_glacier_data_inspection_analysis_41_1.png" />
</div>
</div>
<p>Now let’s take a look at the x and y components of velocity, again averaging over time:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span> <span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>

<span class="n">sample_glacier_raster</span><span class="o">.</span><span class="n">vx</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;mid_date&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
<span class="n">sample_glacier_raster</span><span class="o">.</span><span class="n">vy</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;mid_date&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">Input In [25],</span> in <span class="ni">&lt;cell line: 3&gt;</span><span class="nt">()</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span> <span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">17</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
<span class="ne">----&gt; </span><span class="mi">3</span> <span class="n">sample_glacier_raster</span><span class="o">.</span><span class="n">vx</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;mid_date&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="n">sample_glacier_raster</span><span class="o">.</span><span class="n">vy</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;mid_date&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="ne">NameError</span>: name &#39;sample_glacier_raster&#39; is not defined
</pre></div>
</div>
<img alt="_images/ind_glacier_data_inspection_analysis_43_1.png" src="_images/ind_glacier_data_inspection_analysis_43_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample_glacier_raster</span><span class="o">.</span><span class="n">v_error</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;mid_date&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">Input In [26],</span> in <span class="ni">&lt;cell line: 1&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">sample_glacier_raster</span><span class="o">.</span><span class="n">v_error</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;mid_date&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>

<span class="ne">NameError</span>: name &#39;sample_glacier_raster&#39; is not defined
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="exploring-its-live-data">
<h2>Exploring ITS_LIVE data<a class="headerlink" href="#exploring-its-live-data" title="Permalink to this headline">#</a></h2>
<p>ITS_LIVE data cubes come with many (53!) variables that carry information about the estimated surface velocities and the satellite images that were used to generate the surface velocity estimates. We won’t examine all of this information here but let’s look at a litte bit.</p>
<p>To start with, let’s look at the satellite imagery used to generate the velocity data.</p>
<p>We see that we have two <code class="docutils literal notranslate"><span class="pre">data_vars</span></code> that indicate which sensor that each image in the image pair at a certain time step comes from. We will “load” these values in to memory since we will use them later.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample_glacier_raster</span><span class="o">.</span><span class="n">satellite_img1</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">Input In [27],</span> in <span class="ni">&lt;cell line: 1&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">sample_glacier_raster</span><span class="o">.</span><span class="n">satellite_img1</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>

<span class="ne">NameError</span>: name &#39;sample_glacier_raster&#39; is not defined
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample_glacier_raster</span><span class="o">.</span><span class="n">satellite_img2</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">Input In [28],</span> in <span class="ni">&lt;cell line: 1&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">sample_glacier_raster</span><span class="o">.</span><span class="n">satellite_img2</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>

<span class="ne">NameError</span>: name &#39;sample_glacier_raster&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">satellite_img1</span></code> and <code class="docutils literal notranslate"><span class="pre">satellite_img2</span></code> variables are 1-dimensional numpy arrays corresponding to the length of the <code class="docutils literal notranslate"><span class="pre">mid_date</span></code> dimension of the data cube. You can see that each element of the array is a string corresponding to a different satellite:
<code class="docutils literal notranslate"><span class="pre">1A</span></code> = Sentinel 1A, <code class="docutils literal notranslate"><span class="pre">1B</span></code> = Sentinel 1B, <code class="docutils literal notranslate"><span class="pre">2A</span></code> = Sentinel 2A
<code class="docutils literal notranslate"><span class="pre">2B</span></code> = Sentinel 2B, <code class="docutils literal notranslate"><span class="pre">8.</span></code> = Landsat8 and <code class="docutils literal notranslate"><span class="pre">9.</span></code> = Landsat9</p>
<p>Let’s re-arrange these string arrays into a format that is easier to work with.</p>
<p>First, we’ll make a set of all the different string values in the satellite image variables:</p>
</div>
<div class="section" id="examining-velocity-data-from-each-satellite-in-its-live-dataset">
<h2>Examining velocity data from each satellite in <code class="docutils literal notranslate"><span class="pre">ITS_LIVE</span></code> dataset<a class="headerlink" href="#examining-velocity-data-from-each-satellite-in-its-live-dataset" title="Permalink to this headline">#</a></h2>
<p>What if we only wanted to look at the velocity estimates from landat8?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">l8_data</span> <span class="o">=</span> <span class="n">sample_glacier_raster</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">sample_glacier_raster</span><span class="p">[</span><span class="s1">&#39;satellite_img1&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;8.&#39;</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">l8_data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">Input In [29],</span> in <span class="ni">&lt;cell line: 1&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">l8_data</span> <span class="o">=</span> <span class="n">sample_glacier_raster</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">sample_glacier_raster</span><span class="p">[</span><span class="s1">&#39;satellite_img1&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;8.&#39;</span><span class="p">,</span> <span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">l8_data</span>

<span class="ne">NameError</span>: name &#39;sample_glacier_raster&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">dataset.where()</span></code> at first seems appropriate to use for kind of operation but there’s actually an easier way. Because we are selecting along a single dimension (<code class="docutils literal notranslate"><span class="pre">mid_date</span></code>), we can use xarray’s <code class="docutils literal notranslate"><span class="pre">.sel()</span></code> method instead. This is more efficient and integrates with <code class="docutils literal notranslate"><span class="pre">dask</span></code> arrays more smoothly.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">l8_condition</span> <span class="o">=</span> <span class="n">sample_glacier_raster</span><span class="o">.</span><span class="n">satellite_img1</span> <span class="o">==</span> <span class="s1">&#39;8.&#39;</span>
<span class="n">l8_subset</span> <span class="o">=</span> <span class="n">sample_glacier_raster</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">mid_date</span><span class="o">=</span><span class="n">l8_condition</span><span class="p">)</span>
<span class="n">l8_subset</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">Input In [30],</span> in <span class="ni">&lt;cell line: 1&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">l8_condition</span> <span class="o">=</span> <span class="n">sample_glacier_raster</span><span class="o">.</span><span class="n">satellite_img1</span> <span class="o">==</span> <span class="s1">&#39;8.&#39;</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">l8_subset</span> <span class="o">=</span> <span class="n">sample_glacier_raster</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">mid_date</span><span class="o">=</span><span class="n">l8_condition</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">l8_subset</span>

<span class="ne">NameError</span>: name &#39;sample_glacier_raster&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>We can see that we are looking at roughly a third of the original time steps. Let’s take a look at the average speeds of the Landsat8-derived velocities:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">l8_subset</span><span class="o">.</span><span class="n">v</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;mid_date&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">Input In [31],</span> in <span class="ni">&lt;cell line: 1&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">l8_subset</span><span class="o">.</span><span class="n">v</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;mid_date&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>

<span class="ne">NameError</span>: name &#39;l8_subset&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>What about Landsat9?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">l9_condition</span> <span class="o">=</span> <span class="n">sample_glacier_raster</span><span class="o">.</span><span class="n">satellite_img1</span> <span class="o">==</span> <span class="s1">&#39;9.&#39;</span>

<span class="n">l9_subset</span> <span class="o">=</span> <span class="n">sample_glacier_raster</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">mid_date</span><span class="o">=</span><span class="n">l9_condition</span><span class="p">)</span>
<span class="n">l9_subset</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">Input In [32],</span> in <span class="ni">&lt;cell line: 1&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">l9_condition</span> <span class="o">=</span> <span class="n">sample_glacier_raster</span><span class="o">.</span><span class="n">satellite_img1</span> <span class="o">==</span> <span class="s1">&#39;9.&#39;</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">l9_subset</span> <span class="o">=</span> <span class="n">sample_glacier_raster</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">mid_date</span><span class="o">=</span><span class="n">l9_condition</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="n">l9_subset</span>

<span class="ne">NameError</span>: name &#39;sample_glacier_raster&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>Only 45 time steps have data from Landsat9, this makes sense because Landsat9 was just launched recently</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">l9_subset</span><span class="o">.</span><span class="n">v</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;mid_date&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">Input In [33],</span> in <span class="ni">&lt;cell line: 1&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">l9_subset</span><span class="o">.</span><span class="n">v</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;mid_date&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>

<span class="ne">NameError</span>: name &#39;l9_subset&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>Let’s look at Sentinel 1 data. Note here we are selecting for 2 values instead of 1 using <a class="reference external" href="https://xarray.pydata.org/en/stable/generated/xarray.DataArray.isin.html">DataArray.isin</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s1_condition</span> <span class="o">=</span> <span class="n">sample_glacier_raster</span><span class="o">.</span><span class="n">satellite_img1</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">&#39;1A&#39;</span><span class="p">,</span><span class="s1">&#39;1B&#39;</span><span class="p">])</span>
<span class="n">s1_subset</span> <span class="o">=</span> <span class="n">sample_glacier_raster</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">mid_date</span> <span class="o">=</span> <span class="n">s1_condition</span><span class="p">)</span>
<span class="n">s1_subset</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">Input In [34],</span> in <span class="ni">&lt;cell line: 1&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">s1_condition</span> <span class="o">=</span> <span class="n">sample_glacier_raster</span><span class="o">.</span><span class="n">satellite_img1</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">&#39;1A&#39;</span><span class="p">,</span><span class="s1">&#39;1B&#39;</span><span class="p">])</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">s1_subset</span> <span class="o">=</span> <span class="n">sample_glacier_raster</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">mid_date</span> <span class="o">=</span> <span class="n">s1_condition</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">s1_subset</span>

<span class="ne">NameError</span>: name &#39;sample_glacier_raster&#39; is not defined
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s1_subset</span><span class="o">.</span><span class="n">v</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;mid_date&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">Input In [35],</span> in <span class="ni">&lt;cell line: 1&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">s1_subset</span><span class="o">.</span><span class="n">v</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;mid_date&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>

<span class="ne">NameError</span>: name &#39;s1_subset&#39; is not defined
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s2_condition</span> <span class="o">=</span> <span class="n">sample_glacier_raster</span><span class="o">.</span><span class="n">satellite_img1</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">&#39;2A&#39;</span><span class="p">,</span><span class="s1">&#39;2B&#39;</span><span class="p">])</span>
<span class="n">s2_subset</span> <span class="o">=</span> <span class="n">sample_glacier_raster</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">mid_date</span><span class="o">=</span><span class="n">s2_condition</span><span class="p">)</span>
<span class="n">s2_subset</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">Input In [36],</span> in <span class="ni">&lt;cell line: 1&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">s2_condition</span> <span class="o">=</span> <span class="n">sample_glacier_raster</span><span class="o">.</span><span class="n">satellite_img1</span><span class="o">.</span><span class="n">isin</span><span class="p">([</span><span class="s1">&#39;2A&#39;</span><span class="p">,</span><span class="s1">&#39;2B&#39;</span><span class="p">])</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">s2_subset</span> <span class="o">=</span> <span class="n">sample_glacier_raster</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">mid_date</span><span class="o">=</span><span class="n">s2_condition</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">s2_subset</span>

<span class="ne">NameError</span>: name &#39;sample_glacier_raster&#39; is not defined
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s2_subset</span><span class="o">.</span><span class="n">v</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;mid_date&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">Input In [37],</span> in <span class="ni">&lt;cell line: 1&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">s2_subset</span><span class="o">.</span><span class="n">v</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="s1">&#39;mid_date&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>

<span class="ne">NameError</span>: name &#39;s2_subset&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>ITS_LIVE is exciting because it combines velocity data from a number of satellites into one accessible and efficient dataset. From this brief look, you can see snapshot overviews of the different data within the dataset and begin to think about processing steps you might take to work with the data further.</p>
</div>
<div class="section" id="checking-coverage-along-a-dimension">
<h2>Checking coverage along a dimension<a class="headerlink" href="#checking-coverage-along-a-dimension" title="Permalink to this headline">#</a></h2>
<p>It would be nice to be able to scan/visualize and observe coverage of a variable along a dimension</p>
<p>First need to make a mask that will tell us all the possible ‘valid’ pixels. ie pixels over ice v. rock.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">valid_pixels</span> <span class="o">=</span> <span class="n">sample_glacier_raster</span><span class="o">.</span><span class="n">v</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">])</span>
<span class="n">valid_pix_max</span> <span class="o">=</span> <span class="n">sample_glacier_raster</span><span class="o">.</span><span class="n">v</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="s1">&#39;mid_date&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">([</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">])</span>

<span class="n">sample_glacier_raster</span><span class="p">[</span><span class="s1">&#39;cov&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">valid_pixels</span><span class="o">/</span><span class="n">valid_pix_max</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">Input In [38],</span> in <span class="ni">&lt;cell line: 1&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">valid_pixels</span> <span class="o">=</span> <span class="n">sample_glacier_raster</span><span class="o">.</span><span class="n">v</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">])</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">valid_pix_max</span> <span class="o">=</span> <span class="n">sample_glacier_raster</span><span class="o">.</span><span class="n">v</span><span class="o">.</span><span class="n">notnull</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="s1">&#39;mid_date&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">([</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">])</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="n">sample_glacier_raster</span><span class="p">[</span><span class="s1">&#39;cov&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">valid_pixels</span><span class="o">/</span><span class="n">valid_pix_max</span>

<span class="ne">NameError</span>: name &#39;sample_glacier_raster&#39; is not defined
</pre></div>
</div>
</div>
</div>
<div class="section" id="looking-into-mid-dates-dimension">
<h3>Looking into <code class="docutils literal notranslate"><span class="pre">mid_dates</span></code> dimension…<a class="headerlink" href="#looking-into-mid-dates-dimension" title="Permalink to this headline">#</a></h3>
<ul class="simple">
<li><p>how many duplicate time steps are there?</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#how many time steps are duplicates?, there are 16872 unique vals in mid_dates</span>
<span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">sample_glacier_raster</span><span class="p">[</span><span class="s1">&#39;mid_date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">Input In [39],</span> in <span class="ni">&lt;cell line: 2&gt;</span><span class="nt">()</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="c1">#how many time steps are duplicates?, there are 16872 unique vals in mid_dates</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="n">np</span><span class="o">.</span><span class="n">unique</span><span class="p">(</span><span class="n">sample_glacier_raster</span><span class="p">[</span><span class="s1">&#39;mid_date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span>

<span class="ne">NameError</span>: name &#39;sample_glacier_raster&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>Start by grouping over <code class="docutils literal notranslate"><span class="pre">mid_date</span></code>. Would expect 16,872 (# unique time steps) with mostly groups of 1, groups of more than one on duplicate coords</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_gb</span> <span class="o">=</span> <span class="n">sample_glacier_raster</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">sample_glacier_raster</span><span class="o">.</span><span class="n">mid_date</span><span class="p">)</span>
<span class="nb">type</span><span class="p">(</span><span class="n">test_gb</span><span class="o">.</span><span class="n">groups</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">Input In [40],</span> in <span class="ni">&lt;cell line: 1&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">test_gb</span> <span class="o">=</span> <span class="n">sample_glacier_raster</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">sample_glacier_raster</span><span class="o">.</span><span class="n">mid_date</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="nb">type</span><span class="p">(</span><span class="n">test_gb</span><span class="o">.</span><span class="n">groups</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;sample_glacier_raster&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">test_gb.groups</span></code> is a <a class="reference external" href="https://xarray.pydata.org/en/stable/generated/xarray.core.groupby.DatasetGroupBy.groups.html">dict</a>, so let’s explore that object. the keys correspond to <code class="docutils literal notranslate"><span class="pre">mid_date</span></code> coords, so the values should be the entries at that coordinate. Want to find dict entries with more than one value…</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">val_ls</span> <span class="o">=</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">test_gb</span><span class="o">.</span><span class="n">groups</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span> 

<span class="n">val_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;num_vals&#39;</span><span class="p">:</span> <span class="n">val_ls</span><span class="p">})</span>
<span class="n">val_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">Input In [41],</span> in <span class="ni">&lt;cell line: 1&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">val_ls</span> <span class="o">=</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">test_gb</span><span class="o">.</span><span class="n">groups</span><span class="o">.</span><span class="n">values</span><span class="p">()]</span> 
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="n">val_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;num_vals&#39;</span><span class="p">:</span> <span class="n">val_ls</span><span class="p">})</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="n">val_df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;test_gb&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>Subset the values dataframe to only keep rows with more than one value per key:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">val_df_sub</span> <span class="o">=</span> <span class="n">val_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">val_df</span><span class="p">[</span><span class="s1">&#39;num_vals&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">val_df_sub</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">Input In [42],</span> in <span class="ni">&lt;cell line: 1&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">val_df_sub</span> <span class="o">=</span> <span class="n">val_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">val_df</span><span class="p">[</span><span class="s1">&#39;num_vals&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">]</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">val_df_sub</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;val_df&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>Interesting, df is 2602 rows (# time steps with more than one entry). How many have more than 2?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">val_df_sub</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">hist</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">Input In [43],</span> in <span class="ni">&lt;cell line: 1&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">val_df_sub</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">hist</span><span class="p">()</span>

<span class="ne">NameError</span>: name &#39;val_df_sub&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>Let’s look at one of the time steps with multiple entries. I used a for loop fn on the first year of the dataset for this (below):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">duplicate_middate</span> <span class="o">=</span> <span class="n">sample_glacier_raster</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">mid_date</span> <span class="o">=</span> <span class="s1">&#39;2013-09-30T04:56:01.528083968&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
<span class="n">duplicate_middate</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">Input In [44],</span> in <span class="ni">&lt;cell line: 1&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">duplicate_middate</span> <span class="o">=</span> <span class="n">sample_glacier_raster</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">mid_date</span> <span class="o">=</span> <span class="s1">&#39;2013-09-30T04:56:01.528083968&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">duplicate_middate</span>

<span class="ne">NameError</span>: name &#39;sample_glacier_raster&#39; is not defined
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mid date: &#39;</span><span class="p">,</span> <span class="n">duplicate_middate</span><span class="o">.</span><span class="n">mid_date</span><span class="o">.</span><span class="n">mid_date</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;image 1 date for entries 1 and 2: &#39;</span><span class="p">,</span> <span class="n">duplicate_middate</span><span class="o">.</span><span class="n">acquisition_date_img1</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;image 2 date for entries 1 and 2: &#39;</span><span class="p">,</span> <span class="n">duplicate_middate</span><span class="o">.</span><span class="n">acquisition_date_img2</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

<span class="n">time_diff1</span> <span class="o">=</span> <span class="n">duplicate_middate</span><span class="o">.</span><span class="n">acquisition_date_img1</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">duplicate_middate</span><span class="o">.</span><span class="n">acquisition_date_img2</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

<span class="n">diff_days1</span> <span class="o">=</span> <span class="n">time_diff1</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;timedelta64[D]&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">diff_days1</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">timedelta64</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;D&#39;</span><span class="p">),</span> <span class="s1">&#39; days&#39;</span><span class="p">)</span>

<span class="n">time_diff2</span> <span class="o">=</span> <span class="n">duplicate_middate</span><span class="o">.</span><span class="n">acquisition_date_img1</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">duplicate_middate</span><span class="o">.</span><span class="n">acquisition_date_img2</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">diff_days2</span> <span class="o">=</span> <span class="n">time_diff2</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;timedelta64[D]&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">diff_days2</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">timedelta64</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;D&#39;</span><span class="p">),</span> <span class="s1">&#39; days&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">Input In [45],</span> in <span class="ni">&lt;cell line: 1&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;mid date: &#39;</span><span class="p">,</span> <span class="n">duplicate_middate</span><span class="o">.</span><span class="n">mid_date</span><span class="o">.</span><span class="n">mid_date</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;image 1 date for entries 1 and 2: &#39;</span><span class="p">,</span> <span class="n">duplicate_middate</span><span class="o">.</span><span class="n">acquisition_date_img1</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;image 2 date for entries 1 and 2: &#39;</span><span class="p">,</span> <span class="n">duplicate_middate</span><span class="o">.</span><span class="n">acquisition_date_img2</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;duplicate_middate&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>In this case, looks like both entries are Landsat8 velocity data, one generated from image pairs 16 days apart and one from image pair 48 days apart. It makes sense that we would have a number of such instances given the range of time-separations among image pairs.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">find_dim_duplicates</span><span class="p">(</span><span class="n">input_xr</span><span class="p">):</span>

    <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">input_xr</span><span class="o">.</span><span class="n">mid_date</span><span class="p">)):</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">element</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">284</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">input_xr</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">mid_date</span><span class="o">=</span><span class="n">element</span><span class="p">)</span><span class="o">.</span><span class="n">mid_date</span><span class="o">.</span><span class="n">data</span> <span class="o">==</span> <span class="n">input_xr</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">mid_date</span><span class="o">=</span><span class="p">(</span><span class="n">element</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">mid_date</span><span class="o">.</span><span class="n">data</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">input_xr</span><span class="o">.</span><span class="n">isel</span><span class="p">(</span><span class="n">mid_date</span><span class="o">=</span><span class="n">element</span><span class="p">)</span><span class="o">.</span><span class="n">mid_date</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">pass</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">find_dim_duplicates</span><span class="p">(</span><span class="n">sample_glacier_raster</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">mid_date</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="s1">&#39;2013-01-01&#39;</span><span class="p">,</span><span class="s1">&#39;2014-01-01&#39;</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">Input In [47],</span> in <span class="ni">&lt;cell line: 1&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">find_dim_duplicates</span><span class="p">(</span><span class="n">sample_glacier_raster</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">mid_date</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="s1">&#39;2013-01-01&#39;</span><span class="p">,</span><span class="s1">&#39;2014-01-01&#39;</span><span class="p">)))</span>

<span class="ne">NameError</span>: name &#39;sample_glacier_raster&#39; is not defined
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="exploring-data-coverage-over-time-series">
<h2>Exploring data coverage over time series<a class="headerlink" href="#exploring-data-coverage-over-time-series" title="Permalink to this headline">#</a></h2>
<p>Let’s take a look at the data coverage over this glacier across the time series:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">sample_glacier_raster</span><span class="o">.</span><span class="n">cov</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span><span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;x&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">Input In [48],</span> in <span class="ni">&lt;cell line: 2&gt;</span><span class="nt">()</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="n">sample_glacier_raster</span><span class="o">.</span><span class="n">cov</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">,</span><span class="n">marker</span> <span class="o">=</span> <span class="s1">&#39;x&#39;</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;sample_glacier_raster&#39; is not defined
</pre></div>
</div>
<img alt="_images/ind_glacier_data_inspection_analysis_87_1.png" src="_images/ind_glacier_data_inspection_analysis_87_1.png" />
</div>
</div>
<p>But what if we wanted to explore the relative coverage of the different sensors that make up the its_live dataset as a whole?
We can use <code class="docutils literal notranslate"><span class="pre">groupby</span></code> to group the data based on a single condition such as <code class="docutils literal notranslate"><span class="pre">satellite_img1</span></code> or <code class="docutils literal notranslate"><span class="pre">mid_date</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample_glacier_raster</span><span class="o">.</span><span class="n">cov</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">sample_glacier_raster</span><span class="o">.</span><span class="n">satellite_img1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">Input In [49],</span> in <span class="ni">&lt;cell line: 1&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">sample_glacier_raster</span><span class="o">.</span><span class="n">cov</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">sample_glacier_raster</span><span class="o">.</span><span class="n">satellite_img1</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;sample_glacier_raster&#39; is not defined
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample_glacier_raster</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;mid_date&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">Input In [50],</span> in <span class="ni">&lt;cell line: 1&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">sample_glacier_raster</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;mid_date&#39;</span><span class="p">)</span>

<span class="ne">NameError</span>: name &#39;sample_glacier_raster&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>However, if we want to examine the coverage of data from different sensor groups over time, we would essentially want to <code class="docutils literal notranslate"><span class="pre">groupby</span></code> two groups. To do this, we use <a class="reference external" href="https://flox.readthedocs.io/en/latest/">flox</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">flox.xarray</span>
</pre></div>
</div>
</div>
</div>
<p>This is the <code class="docutils literal notranslate"><span class="pre">xr.DataArray</span></code> on which we will perform the grouping operation using <code class="docutils literal notranslate"><span class="pre">flox</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample_glacier_raster</span><span class="o">.</span><span class="n">cov</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">Input In [52],</span> in <span class="ni">&lt;cell line: 1&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">sample_glacier_raster</span><span class="o">.</span><span class="n">cov</span>

<span class="ne">NameError</span>: name &#39;sample_glacier_raster&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>Using <code class="docutils literal notranslate"><span class="pre">flox</span></code>, we will define a coverage object that takes as inputs the data we want to reduce, the groups we want to use to group the data and the reduction we want to perform.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">coverage</span> <span class="o">=</span> <span class="n">flox</span><span class="o">.</span><span class="n">xarray</span><span class="o">.</span><span class="n">xarray_reduce</span><span class="p">(</span>
    <span class="c1"># array to reduce</span>
    <span class="n">sample_glacier_raster</span><span class="o">.</span><span class="n">cov</span><span class="p">,</span>
    <span class="c1"># Grouping by two variables</span>
    <span class="n">sample_glacier_raster</span><span class="o">.</span><span class="n">satellite_img1</span><span class="o">.</span><span class="n">compute</span><span class="p">(),</span>
    <span class="n">sample_glacier_raster</span><span class="o">.</span><span class="n">mid_date</span><span class="p">,</span>
    <span class="c1"># reduction to apply in each group</span>
    <span class="n">func</span><span class="o">=</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span>
    <span class="c1"># for when no elements exist in a group</span>
    <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">Input In [53],</span> in <span class="ni">&lt;cell line: 1&gt;</span><span class="nt">()</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="n">coverage</span> <span class="o">=</span> <span class="n">flox</span><span class="o">.</span><span class="n">xarray</span><span class="o">.</span><span class="n">xarray_reduce</span><span class="p">(</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span>     <span class="c1"># array to reduce</span>
<span class="ne">----&gt; </span><span class="mi">3</span>     <span class="n">sample_glacier_raster</span><span class="o">.</span><span class="n">cov</span><span class="p">,</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span>     <span class="c1"># Grouping by two variables</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span>     <span class="n">sample_glacier_raster</span><span class="o">.</span><span class="n">satellite_img1</span><span class="o">.</span><span class="n">compute</span><span class="p">(),</span>
<span class="g g-Whitespace">      </span><span class="mi">6</span>     <span class="n">sample_glacier_raster</span><span class="o">.</span><span class="n">mid_date</span><span class="p">,</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span>     <span class="c1"># reduction to apply in each group</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span>     <span class="n">func</span><span class="o">=</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span>
<span class="g g-Whitespace">      </span><span class="mi">9</span>     <span class="c1"># for when no elements exist in a group</span>
<span class="g g-Whitespace">     </span><span class="mi">10</span>     <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
<span class="g g-Whitespace">     </span><span class="mi">11</span> <span class="p">)</span>

<span class="ne">NameError</span>: name &#39;sample_glacier_raster&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>Now we can visualize the coverage over time for each sensor in the its_live dataset. Cool!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">coverage</span><span class="o">.</span><span class="n">mid_date</span><span class="p">,</span> <span class="n">coverage</span><span class="o">.</span><span class="n">satellite_img1</span><span class="p">,</span> <span class="n">coverage</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">Input In [54],</span> in <span class="ni">&lt;cell line: 1&gt;</span><span class="nt">()</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">coverage</span><span class="o">.</span><span class="n">mid_date</span><span class="p">,</span> <span class="n">coverage</span><span class="o">.</span><span class="n">satellite_img1</span><span class="p">,</span> <span class="n">coverage</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">)</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">()</span>

<span class="ne">NameError</span>: name &#39;coverage&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>This notebook displayed basic data inspection steps that you can take when working with a new dataset. The following notebooks will demonstrate further processing, analytical and visualization steps you can take.</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="accessing_s3_data_noregion.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Accessing ITS_LIVE data via S3 bucket</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="ind_glacier_analysis_new.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Individual glacier surface velocity analysis</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By emma marshall<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>